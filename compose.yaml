services:
  main:
    build:
      context: main_server
      dockerfile: Dockerfile
    ports:
      - "8000:8000"
    networks:
      - mynetwork

  secondary:
    build:
      context: lev_secondary_server
      dockerfile: Dockerfile
    ports:
      - "7000-7002:8000"
    networks:
      - mynetwork
    deploy:
      mode: replicated
      replicas: 3




networks:
  mynetwork:
    driver: bridge

